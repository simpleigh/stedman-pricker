/**
 * Free Stedman Pricker
 * @author Leigh Simpson <code@simpleigh.com>
 * @license GPL-3.0
 * @copyright Â© 2015-17 Leigh Simpson. All rights reserved.
 */

/**
 * Renders a touch in gsiril format
 * @param {number}  touchRows - rows in the touch
 */

{{
	var courseNames = [ ];
	context.touchRows = context.touchRows || Infinity;
	context.touchRows -= 2;  /* TODO: magic number */
}}

// Generated by Free Stedman Pricker{{= '\n' }}
// https://github.com/simpleigh/stedman-pricker{{= '\n' }}

// {{= Pricker.stringFromRow(context.object.getInitialRow()) }}{{= '\n' }}
{{~ context.object.getCourses() :course }}
	// {{= course.print('text') }}{{= '\n' }}
{{~}}
{{= '\n' }}

{{= context.object.getInitialRow().length }} bells{{= '\n' }}
{{= '\n' }}

slow = +3.1.3.1.3{{= '\n' }}
quick = +1.3.1.3.1{{= '\n' }}

{{? context.object.getInitialRow().length == 7 }}
	plain = +7{{= '\n' }}
	bob = +5{{= '\n' }}
	single = +567{{= '\n' }}
{{?? context.object.getInitialRow().length == 9 }}
	plain = +9{{= '\n' }}
	bob = +7{{= '\n' }}
	single = +789{{= '\n' }}
{{?? context.object.getInitialRow().length == 11 }}
	plain = +E{{= '\n' }}
	bob = +9{{= '\n' }}
	single = +90E{{= '\n' }}
{{?? context.object.getInitialRow().length == 13 }}
	plain = +A{{= '\n' }}
	bob = +E{{= '\n' }}
	single = +ETA{{= '\n' }}
{{?? context.object.getInitialRow().length == 15 }}
	plain = +C{{= '\n' }}
	bob = +A{{= '\n' }}
	single = +ABC{{= '\n' }}
{{?}}
{{= '\n' }}

{{~ context.object.getCourses() :course:index }}
	course{{= index + 1 }} = 
	 /* single space */
	{{= course.print('gsiril', {'touchRows': context.touchRows}) }}
	{{ courseNames.push('course' + (index + 1)); }}

	{{ context.touchRows -= course.estimateRows(); }}
	{{? context.touchRows <= 0 }}
		{{ break; }}
	{{?}}
{{~}}
{{= '\n' }}

prove +3.1,
 /* single space */
{{= courseNames.join(', ') }}
