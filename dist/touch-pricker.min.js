/**
 * Free Touch Pricker
 * @author Leigh Simpson <code@simpleigh.com>
 * @license GPL-3.0
 * @copyright Copyright 2015-18 Leigh Simpson. All rights reserved.
 * @version 1.1.0
 */

!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.Pricker=e()}(this,function(){"use strict";var t=this&&this.__assign||Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++){e=arguments[i];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},e=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();!function(e){var i=function(){function i(){}return i.prototype.print=function(i,n){return void 0===n&&(n={}),i=this.templatePath+"."+i,e.Templates[i](t({},n,{object:this}))},i.makePrintable=function(t){t.prototype.print=i.prototype.print},i}();e.PrintableMixin=i}(i||(i={}));!function(t){!function(t){t[t.Triples=7]="Triples",t[t.Caters=9]="Caters",t[t.Cinques=11]="Cinques",t[t.Sextuples=13]="Sextuples",t[t.Septuples=15]="Septuples"}(t.Stage||(t.Stage={}))}(i||(i={}));!function(t){t.rowFromString=function(t,e){var i,n,o={1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,0:10,E:11,T:12,A:13,B:14,C:15},r=[],s=[];if((t=t.toUpperCase()).length>e)throw new Error("Row too long");for(i=1;i<=e;i+=1)r[i]=!1;for(n=0;n<t.length&&n<e;n+=1){if(!((i=o[t.charAt(n)])&&i<=e))throw new Error("Unknown bell");if(r[i])throw new Error("Bell repeated");s.push(i),r[i]=!0}if(t.length<e)for(i=1;i<=e;i+=1)r[i]||s.push(i);return s}}(i||(i={}));!function(t){t.stringFromRow=function(t){for(var e=[],i=0,n=t;i<n.length;i++){var o=n[i];e.push(" 1234567890ETABC".charAt(o))}return e.join("")}}(i||(i={}));!function(t){!function(e){var i=function(){function e(){this._visiting=!0}return e.prototype.visit=function(e,i){return this._rounds||(this._rounds=t.stringFromRow(t.rowFromString("",e.length))),this._visiting&&(this.visitImplementation(e,i),t.stringFromRow(e)===this._rounds&&(this._visiting=!1)),this},e.prototype.isVisiting=function(){return this._visiting},e}();e.AbstractVisitor=i}(t.Visitor||(t.Visitor={}))}(i||(i={}));!function(t){var e=function(){function t(t,e){this._ownership=e,this.templatePath="AbstractBlock",this._initialRow=t.slice()}return t.prototype.getInitialRow=function(){return this._initialRow.slice()},t.prototype.setInitialRow=function(t){return this._initialRow=t.slice(),this.calculate(),this},t.prototype.setOwnership=function(t){return this._ownership=t,this},t.prototype.getContainer=function(){return this._ownership?this._ownership.container:void 0},t.prototype.getIndex=function(){return this._ownership?this._ownership.index:void 0},t.prototype.clearOwnership=function(){return this._ownership=void 0,this},t.prototype.notifyContainer=function(){this._ownership&&this._ownership.container.notify(this._ownership.index)},t}();t.AbstractBlock=e,t.PrintableMixin.makePrintable(e)}(i||(i={}));!function(t){var i=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e._blocks=[],e}return e(i,t),i.prototype.calculate=function(){this.propagateBlocks()},i.prototype.getLast=function(){return this._blocks.length?this._blocks[this._blocks.length-1].getLast():this._initialRow.slice()},i.prototype.accept=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0,n=this._blocks;i<n.length;i++)for(var o=n[i],r=0,s=t;r<s.length;r++){var a=s[r];o.accept(a)}return this},i.prototype.estimateRows=function(){for(var t=0,e=0,i=this._blocks;e<i.length;e++){t+=i[e].estimateRows()}return t},i.prototype.notify=function(t){this.propagateBlocks(t),this.notifyContainer()},i.prototype.propagateBlocks=function(t){for(void 0===t&&(t=0),!t&&this.getLength()&&(this.propagateFirstBlock(this._blocks[0]),t=1);t<this.getLength();t+=1)this.propagateCurrentBlock(this._blocks[t-1],this._blocks[t])},i.prototype.propagateCurrentBlock=function(t,e){e.setInitialRow(t.getLast())},i.prototype.propagateFirstBlock=function(t){t.setInitialRow(this._initialRow)},i.prototype.getLength=function(){return this._blocks.length},i.prototype.getBlocks=function(){return this._blocks.slice()},i.prototype.getBlock=function(t){if(t<1||t>this.getLength())throw new Error("Block index out of range");return this._blocks[t-1]},i}(t.AbstractBlock);t.AbstractContainer=i}(i||(i={}));!function(t){!function(t){t[t.Plain=0]="Plain",t[t.Bob=1]="Bob",t[t.Single=2]="Single"}(t.Call||(t.Call={}))}(i||(i={}));!function(t){!function(e){function i(t,e){var i;i=t[e],t[e]=t[e+1],t[e+1]=i}function n(t){var e;for(e=0;e<t.length-3;e+=2)i(t,e)}e.permute1=function(t){var e;for(e=1;e<t.length-1;e+=2)i(t,e)},e.permute3=function(t){var e;for(i(t,0),e=3;e<t.length-1;e+=2)i(t,e)},e.permuteN=function(t){var e;for(e=0;e<t.length-1;e+=2)i(t,e)},e.permuteBob=function(t){n(t),i(t,t.length-2)},e.permuteSingle=n,e.permuteCall=function(i,n){n===t.Call.Plain?e.permuteN(i):n===t.Call.Bob?e.permuteBob(i):n===t.Call.Single&&e.permuteSingle(i)}}(t.Changes||(t.Changes={}))}(i||(i={}));!function(t){!function(t){t[t.Slow=0]="Slow",t[t.Quick=1]="Quick"}(t.SixType||(t.SixType={}))}(i||(i={}));!function(t){var i=function(i){function n(e,n){var o=i.call(this,e,n)||this;return o._ownership=n,o._call=t.Call.Plain,o.templatePath="AbstractSix",o.calculate(),o}return e(n,i),n.prototype.calculate=function(){this._end=this._initialRow.slice(),t.Changes.permuteCall(this._end,this._call),this.applySixTransposition()},n.prototype.getLast=function(){return this._end.slice()},n.prototype.estimateRows=function(){return 6},n.prototype.getHead=function(){var e=this._initialRow.slice();return t.Changes.permuteCall(e,this._call),e},n.prototype.getEnd=function(){return this.getLast()},n.prototype.getCall=function(){return this._call},n.prototype.setCall=function(t,e){return void 0===e&&(e=!0),this._call=t,e&&(this.calculate(),this.notifyContainer()),this},n.prototype.toggleCall=function(){var t=(this._call+1)%3;return this.setCall(t),t},n}(t.AbstractBlock);t.AbstractSix=i}(i||(i={}));!function(t){var e=function(){function e(){this._directory=[]}return e.prototype.add=function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var o,r;if("object"==typeof t?i=e.getIndices(t):i.unshift(t),!(r=i.pop()))throw new Error("Bad ownership: must have at least one index");o=this._directory;for(var s=0,a=i;s<a.length;s++){var c=a[s];o[c]||(o[c]=[]),o=o[c]}return o[r]=!0,this},e.prototype.contains=function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var o;"object"==typeof t?i=e.getIndices(t):i.unshift(t),o=this._directory;for(var r=0,s=i;r<s.length;r++){var a=s[r];if(!o[a])return!1;o=o[a]}return!0},e.getIndices=function(e){var i,n,o=[];if(n=e.getIndex(),!(i=e.getContainer()))throw new Error("Bad ownership: block has no container");for(;i instanceof t.AbstractBlock;){if(!n)throw new Error("Bad ownership: container but no index");o.unshift(n),n=i.getIndex(),i=i.getContainer()}return o},e.prototype.isEmpty=function(){return!this._directory.length},e}();t.BlockDirectory=e}(i||(i={}));!function(t){var i=function(t){function i(e,i){var n=t.call(this,e,i)||this;return n._ownership=i,n.extend(n.getDefaultLength(e)),n}return e(i,t),i.prototype.extend=function(t){var e,i=this.getLength(),n=i+t,o=this.getLast();for(e=i+1;e<=n;e+=1)this._blocks[e-1]=this.createBlock(o,e),o=this._blocks[e-1].getLast();return this},i.prototype.getDefaultLength=function(t){return 1},i.prototype.setLength=function(t){if(t<this.minLength||t>this.maxLength)throw new Error("Length out of range");return t>this.getLength()?this.extend(t-this.getLength()):this._blocks=this._blocks.slice(0,t),this.notifyContainer(),this},i.prototype.safeSetLength=function(t){return t=Math.max(t,this.minLength),t=Math.min(t,this.maxLength),this.setLength(t)},i}(t.AbstractContainer);t.SerialContainer=i}(i||(i={}));!function(t){var i=function(i){function n(){var e=null!==i&&i.apply(this,arguments)||this;return e._firstSixType=t.SixType.Slow,e.templatePath="Course",e.minLength=2,e.maxLength=60,e.getEnd=e.getLast,e.getSixes=e.getBlocks,e.getSix=e.getBlock,e}return e(n,i),n.prototype.getDefaultLength=function(t){return 2*t.length},n.prototype.createBlock=function(e,i){return((this._firstSixType||t.SixType.Slow)+i)%2?new t.Slow(e,{container:this,index:i}):new t.Quick(e,{container:this,index:i})},n.prototype.getFirstSixType=function(){return this._firstSixType},n.prototype.setFirstSixType=function(t){if(this._firstSixType===t)return this;this._firstSixType=t;for(var e=this._initialRow,i=[],n=1;n<=this.getLength();n+=1){var o=this.createBlock(e,n);o.setCall(this.getSix(n).getCall(),!1),i.push(o),e=i[n-1].getLast()}return this._blocks=i,i.length&&this.getSix(1).setCall(this.getSix(1).getCall()),this},n.prototype.resetLength=function(){return this.setLength(this.getDefaultLength(this._initialRow)),this},n.prototype.resetCalls=function(){for(var e=0,i=this._blocks;e<i.length;e++){i[e].setCall(t.Call.Plain,!1)}return this.getSix(1).setCall(t.Call.Plain),this},n.prototype.isPlain=function(){for(var t=0,e=this._blocks;t<e.length;t++){if(e[t].getCall())return!1}return!0},n.prototype.clone=function(){var t=new n(this._initialRow);t.setLength(this.getLength()),t.setFirstSixType(this.getFirstSixType());for(var e=1;e<=this.getLength();e+=1)t.getSix(e).setCall(this.getSix(e).getCall(),!1);return t.getSix(1).setCall(this.getSix(1).getCall()),t},n.fromString=function(e,i){var o,r,s,a=new n(e),c=new RegExp("^\\s*(?:[0-9a-z]{3,15}\\s+)?((?:\\d{1,2}|\\d{1,2}s|s\\d{1,2})(?:[\\s.,]+(?:\\d{1,2}|\\d{1,2}s|s\\d{1,2}))*|p)(?:\\s+\\((\\d{1,2})[^\\d\\)]*\\))?\\s*$","i").exec(i);if(!c)throw new Error("Cannot import course");if(c[2]&&a.setLength(parseInt(c[2])),"p"===c[1])return a;for(o=c[1].split(new RegExp("[\\s.,]+")),r=0;r<o.length;r+=1)"s"===(s=o[r]).charAt(0)?(s=s.slice(1),a.getSix(parseInt(s)).setCall(t.Call.Single)):"s"===s.slice(-1)?(s=s.slice(0,-1),a.getSix(parseInt(s)).setCall(t.Call.Single)):a.getSix(parseInt(s)).setCall(t.Call.Bob);return a},n}(t.SerialContainer);t.Course=i}(i||(i={}));!function(t){var i=function(i){function n(){var e=null!==i&&i.apply(this,arguments)||this;return e.type=t.SixType.Quick,e.notation=n.notation,e}return e(n,i),n.prototype.accept=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];for(var n=this.getInitialRow(),o=0,r=e;o<r.length;o++){var s=r[o];t.Changes.permuteCall(n,this._call),s.visit(n,this),t.Changes.permute1(n),s.visit(n,this),t.Changes.permute3(n),s.visit(n,this),t.Changes.permute1(n),s.visit(n,this),t.Changes.permute3(n),s.visit(n,this),s.visit(this._end,this)}return this},n.prototype.applySixTransposition=function(){t.Changes.permute3(this._end)},n.notation=["1","3","1","3","1"],n}(t.AbstractSix);t.Quick=i}(i||(i={}));!function(t){var i=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i.prototype.insertBlock=function(t,e){return this._blocks.splice(t-1,0,e),this.fixupOwnership(t),this.notify(t-1),this},i.prototype.deleteBlock=function(t){var e=this.getBlock(t);return this._blocks.splice(t-1,1),e.clearOwnership(),this.fixupOwnership(t),this.notify(t-1),e},i.prototype.fixupOwnership=function(t){for(var e=t;e<=this.getLength();e+=1)this.getBlock(e).setOwnership({container:this,index:e})},i}(t.AbstractContainer);t.RandomAccessContainer=i}(i||(i={}));!function(t){var i=function(i){function n(){var e=null!==i&&i.apply(this,arguments)||this;return e.type=t.SixType.Slow,e.notation=n.notation,e}return e(n,i),n.prototype.accept=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];for(var n=this.getInitialRow(),o=0,r=e;o<r.length;o++){var s=r[o];t.Changes.permuteCall(n,this._call),s.visit(n,this),t.Changes.permute3(n),s.visit(n,this),t.Changes.permute1(n),s.visit(n,this),t.Changes.permute3(n),s.visit(n,this),t.Changes.permute1(n),s.visit(n,this),s.visit(this._end,this)}return this},n.prototype.applySixTransposition=function(){t.Changes.permute1(this._end)},n.notation=["3","1","3","1","3"],n}(t.AbstractSix);t.Slow=i}(i||(i={}));!function(t){var i=function(i){function n(e,n){var o=i.call(this,e,n)||this;return o._ownership=n,o.templatePath="Start",o._rowIndex=4,o._sixType=t.SixType.Quick,o.calculate(),o}return e(n,i),n.prototype.calculate=function(){var e=this._initialRow.slice();if(this._rows=[],6!==this._rowIndex){for(var i=(this._rowIndex+this._sixType)%2?t.Changes.permute1:t.Changes.permute3,n=this._rowIndex;n<6;n+=1)(i=i===t.Changes.permute1?t.Changes.permute3:t.Changes.permute1)(e),this._rows.push(e.slice());this._lastRow=this._rows[this._rows.length-1]}else this._lastRow=e},n.prototype.getLast=function(){return this._lastRow.slice()},n.prototype.accept=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0,n=t;i<n.length;i++)for(var o=n[i],r=0,s=this._rows;r<s.length;r++){var a=s[r];o.visit(a)}return this},n.prototype.estimateRows=function(){return this._rows.length},n.prototype.getRowIndex=function(){return this._rowIndex},n.prototype.setRowIndex=function(t){if(void 0===t&&(t=4),t<1||t>6)throw new Error("Row index out of range");return this._rowIndex=t,this.calculate(),this.notifyContainer(),this},n.prototype.getSixType=function(){return this._sixType},n.prototype.setSixType=function(e){return void 0===e&&(e=t.SixType.Quick),this._sixType=e,this.calculate(),this.notifyContainer(),this},n.prototype.setFromString=function(e){var i=null,n=null,o={first:1,"1st":1,1:1,second:2,"2nd":2,2:2,third:3,"3rd":3,3:3,fourth:4,"4th":4,4:4,fifth:5,"5th":5,5:5,sixth:6,"6th":6,6:6};for(var r in o)if(r){new RegExp(r,"i").test(e)&&(i=o[r])}if(/slow/i.test(e)&&(n=t.SixType.Slow),/quick/i.test(e)&&(n=t.SixType.Quick),null===i)throw new Error("Could not determine row index");if(null===n)throw new Error("Could not determine six type");return this._rowIndex=i,this._sixType=n,this.calculate(),this.notifyContainer(),this},n}(t.AbstractBlock);t.Start=i}(i||(i={}));!function(t){t.Templates={}}(i||(i={}));!function(t){var i=function(i){function n(e,n){var o=i.call(this,e,n)||this;return o._ownership=n,o.templatePath="Touch",o.getCourses=o.getBlocks,o.getCourse=o.getBlock,o.insertCourse=o.insertBlock,o.deleteCourse=o.deleteBlock,o._start=new t.Start(e,{container:o,index:0}),o}return e(n,i),n.prototype.accept=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0,o=t;n<o.length;n++){var r=o[n];this._start.accept(r)}return i.prototype.accept.apply(this,t)},n.prototype.estimateRows=function(){return this._start.estimateRows()+i.prototype.estimateRows.call(this)},n.prototype.propagateCurrentBlock=function(t,e){var i=t.getSix(t.getLength()).type;e.setInitialRow(t.getLast()),e.setFirstSixType((i+1)%2)},n.prototype.propagateFirstBlock=function(t){var e=this._start.getSixType();t.setInitialRow(this._start.getLast()),t.setFirstSixType((e+1)%2)},n.prototype.getStart=function(){return this._start},n.fromString=function(e){var i,o,r,s,a,c=e.split("\n");for(i=0;i<c.length;i+=1)if(o=c[i],o=o.replace(/\/\/.*$/,""),o=o.replace(/^\//,""),!/^\s*$/.test(o))if(/start/i.test(o))a=o;else if(s)r=t.Course.fromString(s.getLast(),o),s.insertCourse(s.getLength()+1,r);else{if(o=o.replace(/\s/g,""),!t.Stage[o.length])throw new Error("Cannot recognise stage");s=new n(t.rowFromString("123",o.length))}if(!s)throw new Error("No input lines");return a&&s.getStart().setFromString(a),s},n}(t.RandomAccessContainer);t.Touch=i}(i||(i={}));!function(t){!function(t){function e(t,e){var i;return"auto"===(i=window.getComputedStyle?getComputedStyle(t)[e]:t.currentStyle[e])?0:parseInt(i)+1}t.getWidth=function(t){return t.offsetWidth+1+e(t,"marginLeft")+e(t,"marginRight")},t.getHeight=function(t){return t.offsetHeight+1+e(t,"marginTop")+e(t,"marginBottom")}}(t.Dom||(t.Dom={}))}(i||(i={}));!function(t){!function(e){var i=function(){function e(t){this._iframe=t}return e.prototype.resize=function(){if(this._iframe){for(var e=this._iframe.contentWindow.document.body.children,i=0,n=0,o=0;o<e.length;o+=1){var r=e[o];i+=t.Dom.getWidth(r),n=Math.max(n,t.Dom.getHeight(r))}this._iframe.width=i+"px",this._iframe.height=n+"px"}},e.prototype.getEl=function(t){return(this._iframe?this._iframe.contentWindow.document:document).getElementById(t)},e}();e.AbstractPricker=i}(t.Pricker||(t.Pricker={}))}(i||(i={}));!function(t){!function(t){t.hide=function(t){t.style.display="none",t.style.visibility="hidden"},t.show=function(t){t.style.display="block",t.style.visibility="visible"}}(t.Dom||(t.Dom={}))}(i||(i={}));!function(t){!function(e){var i=function(){function e(e){this._stage=e,this.templatePath="Music.AbstractScheme",this._matchers=this.createMatchers(t.stringFromRow(t.rowFromString("",e)))}return e.prototype.match=function(t){for(var e=!1,i=0,n=this._matchers;i<n.length;i++){var o=n[i];if(o){var r=o.match(t);e=e||r}}return e},e.prototype.getMatchCount=function(){for(var t=0,e=0,i=this._matchers;e<i.length;e++){var n=i[e];n&&(t+=n.getMatchCount())}return t},e.prototype.getMatchers=function(){return this._matchers.slice()},e}();e.AbstractScheme=i,t.PrintableMixin.makePrintable(i)}(t.Music||(t.Music={}))}(i||(i={}));!function(t){!function(t){!function(t){t[t.Back=-1]="Back",t[t.Row=0]="Row",t[t.Front=1]="Front"}(t.MatchType||(t.MatchType={}))}(t.Music||(t.Music={}))}(i||(i={}));!function(t){!function(e){var i=function(){function t(t,i,n){void 0===n&&(n=e.MatchType.Back),this._pattern=t,this._name=i,this._type=n,this._matchCount=0,this.templatePath="Music.Pattern"}return t.prototype.match=function(t){return this._type===e.MatchType.Back?t=t.slice(-this._pattern.length):this._type===e.MatchType.Front&&(t=t.slice(0,this._pattern.length)),t===this._pattern&&(this._matchCount+=1,!0)},t.prototype.getName=function(){return void 0===this._name?this._pattern:this._name},t.prototype.getMatchCount=function(){return this._matchCount},t.prototype.isWildcardMatch=function(){return this._type!==e.MatchType.Row},t}();e.Pattern=i,t.PrintableMixin.makePrintable(i)}(t.Music||(t.Music={}))}(i||(i={}));!function(t){!function(e){var i=function(){function t(t,e,i){this._name=t,this._parentPattern=i,this.templatePath="Music.PatternGroup",this._patterns=e.slice()}return t.prototype.match=function(t){for(var e=!1,i=0,n=this._patterns;i<n.length;i++){var o=n[i];if(o){var r=o.match(t);e=e||r}}return this._parentPattern&&this._parentPattern.match(t),e},t.prototype.getName=function(){return this._name},t.prototype.getMatchCount=function(){return this._parentPattern?this._parentPattern.getMatchCount():this.getSubmatchCount()},t.prototype.getPatterns=function(){return this._patterns.slice()},t.prototype.getSubmatchCount=function(){for(var t=0,e=0,i=this._patterns;e<i.length;e++){var n=i[e];n&&(t+=n.getMatchCount())}return t},t}();e.PatternGroup=i,t.PrintableMixin.makePrintable(i)}(t.Music||(t.Music={}))}(i||(i={}));!function(t){!function(i){var n=function(n){function o(){return null!==n&&n.apply(this,arguments)||this}return e(o,n),o.prototype.getName=function(){return"MBD scheme"},o.prototype.createMatchers=function(e){var n,o,r=[];n=e.slice(4-this._stage),r.push(new i.Pattern(n)),n=e.slice(4-this._stage,-2)+e.slice(-1)+e.slice(-2,-1),r.push(new i.Pattern(n)),n="65"+e.slice(6-this._stage),r.push(new i.Pattern(n)),o=[];for(s=0;s<this._stage-1;s+=1)n=e.slice(0,s)+e.charAt(s+1)+e.charAt(s)+e.slice(s+2),o.push(new i.Pattern(n,e.charAt(s+1)+e.charAt(s),i.MatchType.Row));switch(r.push(new i.PatternGroup("near misses",o)),this._stage){case t.Stage.Triples:r.push(new i.PatternGroup("468",[new i.Pattern("246","2468"),new i.Pattern("75346","753468"),new i.Pattern("1357246","Queens",i.MatchType.Row),new i.Pattern("7531246","Reverse Queens",i.MatchType.Row),new i.Pattern("1275346","Whittingtons",i.MatchType.Row)],new i.Pattern("46")));break;case t.Stage.Caters:r.push(new i.PatternGroup("680",[new i.Pattern("468","4680"),new i.Pattern("97568","975680"),new i.Pattern("135792468","Queens",i.MatchType.Row),new i.Pattern("975312468","Reverse Queens",i.MatchType.Row),new i.Pattern("123497568","Whittingtons",i.MatchType.Row)],new i.Pattern("68")));break;case t.Stage.Cinques:r.push(new i.PatternGroup("80T",[new i.Pattern("680","680T"),new i.Pattern("E9780","E9780T"),new i.Pattern("13579E24680","Queens",i.MatchType.Row),new i.Pattern("E9753124680","Reverse Queens",i.MatchType.Row),new i.Pattern("531246E9780","Double Whittingtons",i.MatchType.Row)],new i.Pattern("80")));break;case t.Stage.Sextuples:r.push(new i.PatternGroup("0TB",[new i.Pattern("80T","80TB"),new i.Pattern("AE90T","AE90TB"),new i.Pattern("13579EA24680T","Queens",i.MatchType.Row),new i.Pattern("AE9753124680T","Reverse Queens",i.MatchType.Row)],new i.Pattern("0T")));break;case t.Stage.Septuples:r.push(new i.PatternGroup("TB",[new i.Pattern("0TB"),new i.Pattern("CAETB"),new i.Pattern("13579EAC24680TB","Queens",i.MatchType.Row),new i.Pattern("CAE9753124680TB","Reverse Queens",i.MatchType.Row)],new i.Pattern("TB")))}if(r.push(new i.PatternGroup("front LB5",[new i.Pattern("12345","12345",i.MatchType.Front),new i.Pattern("54321","54321",i.MatchType.Front),new i.Pattern("23456","23456",i.MatchType.Front),new i.Pattern("65432","65432",i.MatchType.Front)])),r.push(new i.PatternGroup("back LB5",[new i.Pattern("12345","12345",i.MatchType.Back),new i.Pattern("54321","54321",i.MatchType.Back),new i.Pattern("23456","23456",i.MatchType.Back),new i.Pattern("65432","65432",i.MatchType.Back)])),r.push(new i.PatternGroup("front LB4",[new i.Pattern("1234","1234",i.MatchType.Front),new i.Pattern("4321","4321",i.MatchType.Front),new i.Pattern("2345","2345",i.MatchType.Front),new i.Pattern("5432","5432",i.MatchType.Front),new i.Pattern("3456","3456",i.MatchType.Front),new i.Pattern("6543","6543",i.MatchType.Front)])),r.push(new i.PatternGroup("back LB4",[new i.Pattern("1234","1234",i.MatchType.Back),new i.Pattern("4321","4321",i.MatchType.Back),new i.Pattern("2345","2345",i.MatchType.Back),new i.Pattern("5432","5432",i.MatchType.Back),new i.Pattern("3456","3456",i.MatchType.Back),new i.Pattern("6543","6543",i.MatchType.Back)])),this._stage===t.Stage.Triples)r.push(new i.PatternGroup("reverse rollups",[new i.Pattern("7654")]));else{o=[];for(var s=this._stage-8;s>=0;s-=1)n=(n=e.split("").reverse().join("")).slice(s,s+4),o.push(new i.Pattern(n));r.push(new i.PatternGroup("reverse rollups",o))}return r},o}(i.AbstractScheme);i.MbdScheme=n}(t.Music||(t.Music={}))}(i||(i={}));!function(t){!function(t){var i=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e._count=0,e}return e(i,t),i.prototype.getCount=function(){return this._count},i.prototype.visitImplementation=function(t,e){this._count+=1},i}(t.AbstractVisitor);t.Counter=i}(t.Visitor||(t.Visitor={}))}(i||(i={}));!function(t){!function(i){var n=function(i){function n(e){var n=i.call(this)||this;return n._matcher=e,n._directory=new t.BlockDirectory,n}return e(n,i),n.prototype.getMatcher=function(){return this._matcher},n.prototype.getDirectory=function(){return this._directory},n.prototype.visitImplementation=function(e,i){this._matcher.match(t.stringFromRow(e))&&i&&this._directory.add(i)},n}(i.AbstractVisitor);i.Music=n}(t.Visitor||(t.Visitor={}))}(i||(i={}));!function(t){!function(i){var n=function(i){function n(){var e=null!==i&&i.apply(this,arguments)||this;return e._rowCounts={},e._directory=new t.BlockDirectory,e._isTrue=!0,e}return e(n,i),n.prototype.getRowCounts=function(){var t={};for(var e in this._rowCounts)this._rowCounts.hasOwnProperty(e)&&(t[e]=this._rowCounts[e].length);return t},n.prototype.getDirectory=function(){return this._directory},n.prototype.isTrue=function(){return this._isTrue},n.prototype.visitImplementation=function(e,i){var n=t.stringFromRow(e);if(n in this._rowCounts){if(1===this._rowCounts[n].length){var o=this._rowCounts[n][0];o&&this._directory.add(o)}this._isTrue=!1,i&&this._directory.add(i),this._rowCounts[n].push(i)}else this._rowCounts[n]=[i]},n}(i.AbstractVisitor);i.Proof=n}(t.Visitor||(t.Visitor={}))}(i||(i={}));!function(t){var i;!function(t){t[t.Course=0]="Course",t[t.Touch=1]="Touch"}(i||(i={}));!function(n){var o=function(n){function o(){var t=null!==n&&n.apply(this,arguments)||this;return t._showSixHeads=!1,t._showAdvancedOptions=!1,t._selectedIndex=0,t.templatePath="Pricker.Mbd",t}return e(o,n),o.prototype.notify=function(t){t===i.Course?(this._extraSixes.setInitialRow(this._course.getEnd()),this._copiedIndex=void 0):t===i.Touch&&(this._rowCount=void 0,this._proofText=void 0,this._falseness=void 0,this._music=void 0),this.redraw()},o.prototype.onLoad=function(){for(var e,i=t.Stage.Triples;i<=t.Stage.Septuples;i+=2)(e=document.createElement("option")).value=i.toString(),e.innerText=t.Stage[i],this.getEl("stage").appendChild(e);this.getEl("stage").value=t.Stage.Cinques.toString(),this.onStage()},o.prototype.onStage=function(){this._stage=parseInt(this.getEl("stage").value),this._initialRow=t.rowFromString("231",this._stage),this._course=new t.Course(this._initialRow,{container:this,index:i.Course}),this._extraSixes=new t.Course(this._initialRow),this._extraSixes.setLength(8),this._touch=new t.Touch(t.rowFromString("",this._stage),{container:this,index:i.Touch}),this._musicScheme=new t.Music.MbdScheme(this._stage),this.notify(i.Touch),this.redrawTouch()},o.prototype.redraw=function(){var e=this._course.clone(),i=this._course.getSix(this._course.getLength());this._extraSixes.setFirstSixType((i.type+1)%2),this._extraSixes.setInitialRow(this._course.getEnd()),this.getEl("sixends").innerHTML=this._course.print("mbd",{falseness:this._falseness,music:this._music,courseIndex:this._copiedIndex,extraSixes:this._extraSixes,showSixHeads:this._showSixHeads}),this.getEl("calling").innerHTML=this._course.print("html"),e.setInitialRow(this._initialRow),e.setFirstSixType(t.SixType.Slow),this.getEl("callingFromRounds").innerHTML=e.print("html"),this.getEl("initialRow").value=t.stringFromRow(this._course.getInitialRow()),this.getEl("firstSix").value=this._course.getFirstSixType().toString(),this._showAdvancedOptions?t.Dom.show(this.getEl("firstSixBlock")):t.Dom.hide(this.getEl("firstSixBlock")),this.getEl("courseLength").value=this._course.getLength().toString(),this._savedCourse?this.getEl("savedCalling").innerHTML=this._savedCourse.print("html"):this.getEl("savedCalling").innerText="None",this.resize()},o.prototype.redrawTouch=function(){this.getEl("proofResult").innerText=this._proofText||"",this._rowCount?this.getEl("numRows").innerText=this._rowCount+" Stedman "+t.Stage[this._stage]:this.getEl("numRows").innerText=this._touch.estimateRows()+" changes",this.getEl("rowIndex").value=this._touch.getStart().getRowIndex().toString(),this.getEl("sixType").value=this._touch.getStart().getSixType().toString(),this._showAdvancedOptions?t.Dom.show(this.getEl("startBlock")):t.Dom.hide(this.getEl("startBlock")),this.getEl("courses").outerHTML='<select id="courses" onclick="pricker.onSelectCourse()" ondblclick="pricker.onCopyCourse()">'+this._touch.print("select",{touchRows:this._rowCount,styleUnreached:"color:gray",falseness:this._falseness,styleFalse:"color:red"})+"</select>",this.getEl("courses").size=Math.max(this._touch.getLength()+1,2),this.getEl("courses").value=this._selectedIndex.toString(),this.resize()},o.prototype.c=function(t){this._course.getSix(t).toggleCall()},o.prototype.onSetInitialRow=function(){var e,i=this.getEl("initialRow").value;try{e=t.rowFromString(i,this._stage)}catch(t){return}this._course.setInitialRow(e),this.redraw()},o.prototype.onResetInitialRow=function(){this._course.setInitialRow(this._initialRow),this.redraw()},o.prototype.onFirstSix=function(){var t=this.getEl("firstSix").value;this._course.setFirstSixType(parseInt(t)),this.redraw()},o.prototype.onSetLength=function(){var t=this.getEl("courseLength").value,e=parseInt(t);e&&this._course.safeSetLength(e)},o.prototype.onResetLength=function(){this._course.resetLength()},o.prototype.onResetCalls=function(){this._course.resetCalls()},o.prototype.onSaveCalling=function(){this._savedCourse=this._course.clone(),this._savedCourse.setInitialRow(this._initialRow),this.redraw()},o.prototype.onLoadCalling=function(){this._savedCourse?(this._course=this._savedCourse.clone(),this._course.setInitialRow(this._initialRow)):this._course=new t.Course(this._initialRow),this._course.setOwnership({container:this,index:i.Course}),this.redraw()},o.prototype.onRowIndex=function(){var t=this.getEl("rowIndex").value;this._touch.getStart().setRowIndex(parseInt(t)),this.redrawTouch()},o.prototype.onSixType=function(){var t=this.getEl("sixType").value;this._touch.getStart().setSixType(parseInt(t)),this.redrawTouch()},o.prototype.onSelectCourse=function(){var t=this.getEl("courses").value;this._selectedIndex=parseInt(t)},o.prototype.onInsertCourse=function(){if(this._selectedIndex+=1,this._touch.insertCourse(this._selectedIndex,this._course.clone()),this.getEl("rolling").checked){var t=this._touch.getCourse(this._selectedIndex),e=t.getSix(t.getLength()).type;this._course.setFirstSixType((e+1)%2),this._course.setInitialRow(t.getEnd()),this._course.resetLength(),this._course.resetCalls()}this.redrawTouch()},o.prototype.onPasteCourse=function(){if(this._selectedIndex){if(this._touch.deleteCourse(this._selectedIndex),this._touch.insertCourse(this._selectedIndex,this._course.clone()),this.getEl("rolling").checked){var t=this._touch.getCourse(this._selectedIndex),e=t.getSix(t.getLength()).type;this._course.setFirstSixType((e+1)%2),this._course.setInitialRow(t.getEnd()),this._selectedIndex=Math.min(this._selectedIndex+1,this._touch.getLength()),this._course.resetLength(),this._course.resetCalls()}this.redrawTouch()}},o.prototype.onCopyCourse=function(){this._selectedIndex&&(this._course=this._touch.getCourse(this._selectedIndex).clone(),this._course.setOwnership({container:this,index:i.Course}),this._copiedIndex=this._selectedIndex,this.redraw())},o.prototype.onCutCourse=function(){this.onCopyCourse(),this.onDeleteCourse()},o.prototype.onDeleteCourse=function(){this._selectedIndex&&(this._touch.deleteCourse(this._selectedIndex),this._selectedIndex=Math.min(this._selectedIndex,this._touch.getLength()),this.redraw(),this.redrawTouch())},o.prototype.onLoadTouch=function(){var e,n=this.getEl("loadSaveTextarea").value;try{e=t.Touch.fromString(n)}catch(t){return}this._stage=e.getInitialRow().length,this.getEl("stage").value=this._stage.toString(),this.onStage(),this._touch=e,this._touch.setOwnership({container:this,index:i.Touch}),this.notify(i.Touch),this.redrawTouch()},o.prototype.onSaveTouch=function(){this.getEl("loadSaveTextarea").value=this._touch.print("text")},o.prototype.onGenerateSiril=function(){this._rowCount||this.onProve(),this.getEl("sirilTextarea").innerText=this._touch.print("siril",{touchRows:this._rowCount})},o.prototype.onAnalyseMusic=function(){var e=new t.Visitor.Music(this._musicScheme);this._touch.accept(e),this.getEl("musicTextarea").innerText=e.getMatcher().print("text"),this._music=e.getDirectory()},o.prototype.onShowSixHeads=function(){var t=this.getEl("showSixHeads");this._showSixHeads=t.checked,this.redraw()},o.prototype.onShowAdvancedOptions=function(){var t=this.getEl("showAdvancedOptions");this._showAdvancedOptions=t.checked,this.redraw(),this.redrawTouch()},o.prototype.onProve=function(){var e=new t.Visitor.Proof,i=new t.Visitor.Counter;return this._touch.accept(e,i),this._rowCount=i.getCount(),this._falseness=e.getDirectory(),e.isTrue()?e.isVisiting()?this._proofText="True, but doesn't come round":this._proofText="Composition is true":this._proofText="Composition is FALSE",this.redraw(),this.redrawTouch(),e.isTrue()},o.prototype.onTab=function(t){for(var e=this.getEl("tabs").children,i=this.getEl("tab_"+t),n=this.getEl("pages").children,o=this.getEl("page_"+t),r=0;r<e.length;r+=1)e[r].className="tab";i.className="tab tab-selected";for(r=0;r<n.length;r+=1)n[r].className="page";o.className="page page-selected",this.resize()},o}(n.AbstractPricker);n.Mbd=o,t.PrintableMixin.makePrintable(o)}(t.Pricker||(t.Pricker={}))}(i||(i={}));!function(t){!function(t){t.createAndAppendStyle=function(t,e){void 0===t&&(t=document),void 0===e&&(e="");var i=t.createElement("style");return i.type="text/css",i.innerText=e,t.head.appendChild(i),i}}(t.Dom||(t.Dom={}))}(i||(i={}));!function(t){!function(t){t.createIframe=function(t){void 0===t&&(t=document);var e=t.createElement("iframe");return e.frameBorder="0",e.scrolling="no",e.src="about:blank",e.style.border="none",e}}(t.Dom||(t.Dom={}))}(i||(i={}));!function(t){!function(t){t.injectIframeData=function(t,e,i){void 0===e&&(e=""),void 0===i&&(i={});var n=t.contentWindow.document;n.open();for(var o in i)i.hasOwnProperty(o)&&(t.contentWindow[o]=i[o]);n.write(e),n.close()}}(t.Dom||(t.Dom={}))}(i||(i={}));!function(t){t.create=function(e,i,n){void 0===i&&(i={}),void 0===n&&(n=document);var o,r=n.getElementById(e);if(!r)throw new Error("Cannot find HTML element: '"+e+"'");if(i.iframe||void 0===i.iframe){var s=t.Dom.createIframe(n);r.appendChild(s),o=new t.Pricker.Mbd(s),t.Dom.injectIframeData(s,t.Templates.create({pricker:o}),{pricker:o})}else o=new t.Pricker.Mbd,t.Dom.createAndAppendStyle(n,o.print("css")),r.innerHTML=o.print("html"),window.pricker=o,n===document&&o.onLoad();return o}}(i||(i={}));!function(t){!function(t){var i=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i.prototype.getName=function(){return"Custom scheme"},i.prototype.createMatchers=function(t){return[]},i.prototype.addMatcher=function(t){this._matchers.push(t)},i}(t.AbstractScheme);t.CustomScheme=i}(t.Music||(t.Music={}))}(i||(i={}));!function(t){!function(i){var n=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return e(n,i),n.prototype.visitImplementation=function(e,i){console.log(t.stringFromRow(e))},n}(i.AbstractVisitor);i.Console=n}(t.Visitor||(t.Visitor={}))}(i||(i={}));var i;return function(t){!function(i){var n=function(i){function n(){var t=null!==i&&i.apply(this,arguments)||this;return t._strings=[],t}return e(n,i),n.prototype.getStrings=function(){return this._strings.slice()},n.prototype.visitImplementation=function(e,i){this._strings.push(t.stringFromRow(e))},n}(i.AbstractVisitor);i.StringArray=n}(t.Visitor||(t.Visitor={}))}(i||(i={})),i.Templates.create=function(t){return'<!DOCTYPE html><html> <head> <title>Free Touch Pricker</title> <style type="text/css"> body { margin: 0px; padding: 0px; } '+t.pricker.print("css")+' </style> <script type="text/javascript"> window.onload = function () { pricker.onLoad(); }; <\/script> </head> <body> '+t.pricker.print("html")+" </body></html>"},i.Templates["AbstractSix.mbd"]=function(t){var e="";if(!0!==t.underline&&(t.underline=!1),t.falseness&&t.courseIndex&&t.falseness.contains(t.courseIndex,t.object.getIndex()))n="falseBlock";else if(t.music&&t.courseIndex&&t.music.contains(t.courseIndex,t.object.getIndex()))n="musicalBlock";else var n="";return e+='<span class="'+n+'">',t.showSixHeads?e+=""+i.stringFromRow(t.object.getHead()):(t.underline&&(e+="<u>"),e+=""+i.stringFromRow(t.object.getEnd()),t.underline&&(e+="</u>")),e+='</span>&nbsp;&nbsp;<span class="'+i.SixType[t.object.type].toLowerCase()+'Six" onclick="pricker.c('+t.object.getIndex()+')">&nbsp;',t.object.getCall()===i.Call.Plain?e+="&nbsp;":t.object.getCall()===i.Call.Bob?e+="-":t.object.getCall()===i.Call.Single&&(e+="s"),e+="&nbsp;</span>&nbsp;&nbsp;"+t.object.getIndex()+"<br />",t.showSixHeads&&(e+='<span class="'+n+'"><u>'+i.stringFromRow(t.object.getEnd())+"</u></span><br />"),e},i.Templates["AbstractSix.siril"]=function(t){var e="";return t.touchRows=t.touchRows||1/0,t.object.getCall()===i.Call.Plain?e+="plain":t.object.getCall()===i.Call.Bob?e+="bob":t.object.getCall()===i.Call.Single&&(e+="single"),e+=", ",t.touchRows>1&&(t.touchRows>=6?e+=""+i.SixType[t.object.type].toLowerCase():e+="+"+t.object.notation.slice(0,t.touchRows-1).join("."),e+=", "),e},i.Templates["Course.html"]=function(t){return"<u>"+i.stringFromRow(t.object.getInitialRow())+"</u><br />"+t.object.print("text")},i.Templates["Course.mbd"]=function(t){var e="<u>"+i.stringFromRow(t.object.getInitialRow())+"</u><br />",n=t.object.getSixes();if(n)for(var o=-1,r=n.length-1;o<r;)(a=n[o+=1]).getIndex()===t.object.getLength()&&(t.underline=!0),e+=""+a.print("mbd",t);if(t.extraSixes){var s=t.extraSixes.getSixes();if(s)for(var a,c=-1,u=s.length-1;c<u;)a=s[c+=1],e+='<span class="extraSix">',t.showSixHeads?e+=i.stringFromRow(a.getHead())+"<br /><u>"+i.stringFromRow(a.getEnd())+"</u>":e+=""+i.stringFromRow(a.getEnd()),e+="</span><br />"}return e},i.Templates["Course.siril"]=function(t){var e="";t.touchRows=t.touchRows||1/0;var i=t.object.getSixes();if(i)for(var n,o=-1,r=i.length-1;o<r&&(n=i[o+=1],e+=""+n.print("siril",{touchRows:t.touchRows}),t.touchRows-=n.estimateRows(),!(t.touchRows<=0)););return e+='"@  '+t.object.print("text",{courseEnd:!1})+'"\n'},i.Templates["Course.text"]=function(t){var e="",n=[];t.end=t.end||"",void 0===t.courseEnd&&(t.courseEnd=!0),t.courseEnd&&(e+=i.stringFromRow(t.object.getEnd())+"  ");var o=t.object.getSixes();if(o)for(var r,s=-1,a=o.length-1;s<a;)(r=o[s+=1]).getCall()&&n.push((r.getCall()===i.Call.Single?"s":"")+r.getIndex());return n.length?e+=""+n.join(" "):e+="p",t.object.getLength()!==2*t.object.getInitialRow().length&&(e+="  ("+t.object.getLength()+" sixes)"),e+=""+t.end},i.Templates["Touch.select"]=function(t){var e="";t.touchRows=t.touchRows||1/0,t.touchRows-=2,t.styleUnreached=t.styleUnreached||"",t.styleFalse=t.styleFalse||"",e+='<option value="0">'+i.stringFromRow(t.object.getStart().getLast())+"</option>";var n=t.object.getCourses();if(n)for(var o,r=-1,s=n.length-1;r<s;)e+='<option value="'+(o=n[r+=1]).getIndex()+'"',t.touchRows<=0&&(e+=' style="'+t.styleUnreached+'"'),t.falseness&&t.falseness.contains(o)&&(e+=' style="'+t.styleFalse+'"'),e+=">"+o.print("text")+"</option>",t.touchRows-=o.estimateRows();return e},i.Templates["Touch.siril"]=function(t){var e="",n=[],o=i.stringFromRow(i.rowFromString("",t.object.getInitialRow().length));t.touchRows=t.touchRows||1/0,t.touchRows-=t.object.getStart().estimateRows(),e+="// Generated by Free Touch Pricker\n// https://github.com/simpleigh/touch-pricker\n\n// "+i.stringFromRow(t.object.getInitialRow())+"\n";var r=t.object.getCourses();if(r)for(var s=-1,a=r.length-1;s<a;)e+="// "+(u=r[s+=1]).print("text")+"\n";e+="\n"+t.object.getInitialRow().length+" bells\n\ncomposition = touch\n\nslow = +3.1.3.1.3\nquick = +1.3.1.3.1\nplain = +"+o.slice(-1)+"\nbob = +"+o.slice(-3,-2)+"\nsingle = +"+o.slice(-3)+"\nstrt = "+t.object.getStart().print("siril")+"\n\n";var c=t.object.getCourses();if(c)for(var u,h=-1,l=c.length-1;h<l&&(u=c[h+=1],e+="course"+(h+1)+" = "+u.print("siril",{touchRows:t.touchRows}),n.push("course"+(h+1)),t.touchRows-=u.estimateRows(),!(t.touchRows<=0)););return e+="\ntouch = strt, "+n.join(", ")+"\n\nprove touch\n"},i.Templates["Touch.text"]=function(t){var e="",n=t.object.getStart().print("text");e+=i.stringFromRow(t.object.getStart().getLast())+"\n";var o=t.object.getCourses();if(o)for(var r=-1,s=o.length-1;r<s;)e+=""+o[r+=1].print("text",{end:"\n"});return n&&(e+=n+"\n"),e},i.Templates["Start.siril"]=function(t){var e="";return e+="+"+[i.Slow,i.Quick][t.object.getSixType()].notation.slice(t.object.getRowIndex()-1).join(".")},i.Templates["Start.text"]=function(t){var e="";return 4===t.object.getRowIndex()&&t.object.getSixType()===i.SixType.Quick||(e+="Start from rounds as the "+["","first","second","third","fourth","fifth","last"][t.object.getRowIndex()]+" row of a "+i.SixType[t.object.getSixType()].toLowerCase()+" six."),e},i.Templates["Music.AbstractScheme.text"]=function(t){var e="",i=t.object.getMatchers();if(i)for(var n=-1,o=i.length-1;n<o;)e+=""+i[n+=1].print("text");return e},i.Templates["Pricker.Mbd.css"]=function(t){return'#sixends { float: left; font-family: "Courier New", "Courier", "monospace"; font-size: 12pt; margin-right: 25px;}#controls { float: left; margin-right: 25px;}.tab { background-color: #EFEFF7; border-color: black; border-radius: 15px 0 0 0; border-style: solid; border-width: 1px 1px 0 1px; cursor: pointer; float: left; height: 20px; line-height: 20px; padding-left: 10px; padding-right: 8px; text-align: center;}.tab-selected { background-color: #BDBDE7; font-weight: bold;}#pages { width: 360px;}.page { border-color: black; border-style: solid; border-width: 1px; clear: left; display: none; padding: 9px; visibility: hidden; width: 340px;}.page-selected { display: block; visibility: visible;}.page div, .page div#savedCalling { margin-bottom: 20px;}.page div:last-of-type { margin-bottom: 0px;}.page form { height: 25px; margin-bottom: 10px;}.page textarea { border-width: 1px; height: 450px; padding: 1px; width: 336px;}#touch { background-color: #EFEFF7; float: left; padding: 10px;}#touch div { margin-bottom: 5px;}#touch div:last-of-type { margin-bottom: 0px;}#courses { margin: 5px 0;}.slowSix { background-color: #F0F0F8; cursor: pointer;}.quickSix { background-color: #E2E2F0; cursor: pointer;}.extraSix { color: #505050;}.falseBlock { color: red;}.musicalBlock { color: gold;}'},i.Templates["Pricker.Mbd.html"]=function(t){return'<div id="sixends"></div><div id="controls"> <div id="tabs"> <div id="tab_pricking" onclick="pricker.onTab(\'pricking\')" class="tab tab-selected">Pricking</div> <div id="tab_loadSave" onclick="pricker.onTab(\'loadSave\')" class="tab">Load/Save</div> <div id="tab_siril"    onclick="pricker.onTab(\'siril\')"    class="tab">Siril</div> <div id="tab_music"    onclick="pricker.onTab(\'music\')"    class="tab">Music</div> <div id="tab_view"     onclick="pricker.onTab(\'view\')"     class="tab">View</div> </div> <div id="pages"> <div class="page page-selected" id="page_pricking"> <div> <label for="stage">Number of bells:</label> <select id="stage" onchange="pricker.onStage()"></select> </div> <div> Course from rounds: <div id="callingFromRounds"></div> </div> <div> From current start row: <div id="calling"></div> </div> <div> <form onsubmit="return false"> <label for="initialRow">Starting row:</label> <input type="text" id="initialRow" size="15" maxLength="15" /> <button onclick="pricker.onSetInitialRow()">Set</button> <button onclick="pricker.onResetInitialRow()">Reset</button> </form> </div> <div id="firstSixBlock"> <label for="firstSix">First six:</label> <select id="firstSix" onchange="pricker.onFirstSix()"> <option value="'+i.SixType.Slow+'">Slow</option> <option value="'+i.SixType.Quick+'">Quick</option> </select> </div> <div> <form onsubmit="return false"> <label for="courseLength">Course length:</label> <input type="text" id="courseLength" size="2" maxLength="2" /> <button onclick="pricker.onSetLength()">Set</button> <button onclick="pricker.onResetLength()">Reset</button> </form> </div> <div> <label for="callReset">Current calling:</label> <button id="callReset" onclick="pricker.onResetCalls()">Reset</button> </div> <div> Saved calling: <div id="savedCalling"></div> <button id="saveCalling" onclick="pricker.onSaveCalling()">Save</button> <button id="loadCalling" onclick="pricker.onLoadCalling()">Load</button> </div> </div> <div class="page" id="page_loadSave"> <form onsubmit="return false"> <button onclick="pricker.onLoadTouch()">Import</button> <button onclick="pricker.onSaveTouch()">Export</button> </form> <textarea id="loadSaveTextarea"></textarea> </div> <div class="page" id="page_siril"> <form onsubmit="return false"> <button onclick="pricker.onGenerateSiril()">Generate</button> </form> <textarea id="sirilTextarea"></textarea> </div> <div class="page" id="page_music"> <form onsubmit="return false"> <button onclick="pricker.onAnalyseMusic()">Analyse</button> </form> <textarea id="musicTextarea"></textarea> </div> <div class="page" id="page_view"> <div> <input type="checkbox" id="showSixHeads" onclick="pricker.onShowSixHeads()" /> <label for="showSixHeads">Show six heads</label> </div> <div> <input type="checkbox" id="showAdvancedOptions" onclick="pricker.onShowAdvancedOptions()" /> <label for="showAdvancedOptions">Show advanced options</label> </div> </div> </div></div><div id="touch"> <div> <button onclick="pricker.onProve()">PROVE</button> <span id="proofResult"></span> </div> <div id="numRows"></div> <div> <label> <input id="rolling" type="checkbox" /> Rolling course entry </label> </div> <div id="startBlock"> Start with rounds as the <select id="rowIndex" onchange="pricker.onRowIndex()"> <option value="1">first</option> <option value="2">second</option> <option value="3">third</option> <option value="4">fourth</option> <option value="5">fifth</option> <option value="6">sixth</option> </select> row of a <select id="sixType" onchange="pricker.onSixType()"> <option value="'+i.SixType.Quick+'">quick</option> <option value="'+i.SixType.Slow+'">slow</option> </select> six. </div> <div> <form onsubmit="return false"> <button onclick="pricker.onInsertCourse()">Insert</button> <button onclick="pricker.onPasteCourse()">Paste</button> <button onclick="pricker.onCopyCourse()">Copy</button> <button onclick="pricker.onCutCourse()">Cut</button> <button onclick="pricker.onDeleteCourse()">Delete</button> </form> <select id="courses"></select> <form onsubmit="return false"> <button onclick="pricker.onInsertCourse()">Insert</button> <button onclick="pricker.onPasteCourse()">Paste</button> <button onclick="pricker.onCopyCourse()">Copy</button> <button onclick="pricker.onCutCourse()">Cut</button> <button onclick="pricker.onDeleteCourse()">Delete</button> </form> </div></div>'},i.Templates["Music.Pattern.text"]=function(t){var e="";return void 0===t.end&&(t.end="\n"),t.object.getMatchCount()>0&&((t.object.isWildcardMatch()||t.object.getMatchCount()>1)&&(e+=t.object.getMatchCount()+" "),e+=""+t.object.getName()+t.end),e},i.Templates["Music.PatternGroup.text"]=function(t){var e="";if(t.object.getMatchCount()>0){if(e+=t.object.getMatchCount()+" "+t.object.getName(),t.object.getSubmatchCount()>0){e+=" (";var i=!0,n=t.object.getPatterns();if(n)for(var o,r=-1,s=n.length-1;r<s;)(o=n[r+=1])&&o.getMatchCount()>0&&(i||(e+=", "),e+=""+o.print("text",{end:""}),i=!1);e+=")"}e+="\n"}return e},i});